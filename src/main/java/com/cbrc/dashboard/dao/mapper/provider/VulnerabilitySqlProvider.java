package com.cbrc.dashboard.dao.mapper.provider;

import org.apache.ibatis.annotations.Param;
import org.apache.ibatis.jdbc.SQL;

public class VulnerabilitySqlProvider {
    public String getVulnList(@Param("systemName") String systemName) {
        SQL sql = new SQL();
        sql.SELECT("(@row_number:=@row_number + 1) AS rn, id, systemname, title, description, severity, discresource, category, funcscene, discdate, repairestatus, repaireddate, discoverer, remarks");
        sql.FROM("srp_vulnerabilities_list s, (select @row_number:=0) t");
        sql.WHERE("s.systemname = #{systemName}");
        sql.ORDER_BY("s.discdate desc");
        return sql.toString();
    }

}





